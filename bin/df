#!/usr/bin/python

import subprocess as sp
import sys

output = sp.check_output(['/usr/bin/df'] + sys.argv[1:]).decode("utf-8")

lines = output.splitlines()
data = []

header = []
common = {}
other  = []

for line in lines:
    toks = line.split(None, 6)
    if toks[0] == 'Filesystem':
        header = toks
    elif toks[0] == 'rootfs':
        continue
    elif toks[0].startswith('/'):
        if toks[0] in common:
            common[toks[0]][5] += (" %s" % toks[5])
        else:
            common[toks[0]] = toks
    else:
        other.append(toks)


fl = [len(i) for i in header]
for k,v in common.items():
    for i in range(len(fl)-1):
        if i == 0:
            fl[i] = max(fl[i], len(v[i]))
        else:
            fl[i] = max(fl[i], len(v[i]) + 1)
for toks in other:
    for i in range(len(fl)-1):
        if i == 0:
            fl[i] = max(fl[i], len(toks[i]))
        else:
            fl[i] = max(fl[i], len(toks[i]) + 1)

def pl(toks):
    print("%s %s %s %s %s %s" % (toks[0].ljust(fl[0]), toks[1].rjust(fl[1]), toks[2].rjust(fl[2]), toks[3].rjust(fl[3]), toks[4].rjust(fl[4]), toks[5]))

pl(header)
for k,v in common.items():
    pl(v)
for toks in other:
    pl(toks)
